---
# FQDN the BitWarden service will use
bitwarden_domain: ~
# Unique for each installation, see https://bitwarden.com/host/
bitwarden_inst_id: ~
bitwarden_inst_key: ~
# Database password
bitwarden_db_pass: ~
# Internal Identity Key
bitwarden_id_key: ~
# Identity Certificate Password
bitwarden_id_cert_pass: ~
# SMTP
bitwarden_smtp_user: ~
bitwarden_smtp_pass: ~
bitwarden_smtp_host: ~
bitwarden_smtp_port: ~
bitwarden_smtp_ssl: false
# YubiKey API
bitwarden_yubico_client_id: ~
bitwarden_yubico_secret_key: ~
# Duo A-Key
bitwarden_duo_akey: ~
# HaveIBeenPwned API Key
bitwarden_duo_hibp_api_key: ~

# Docker Compose settings
bitwarden_compose_state: present
bitwarden_compose_recreate: never
bitwarden_compose_restart: true

# UID & GID for container
bitwarden_container_uid: 1000
bitwarden_container_gid: 1000

# reply email
bitwarden_reply_email: 'no-reply@{{ bitwarden_domain | mandatory }}'

# List of email addresses for bootstrapped admins
# see https://help.bitwarden.com/article/admin-portal/
bitwarden_admin_emails: []
# Should registartion be open
bitwarden_disable_registration: true

# Proxy settings
bitwarden_listen_port: 5000
bitwarden_proxy_port: 5001

# WARNING: Changing this might require role updates
bitwarden_version: '1.31.1'

# Compose & config files source
bitwarden_stub_url: 'https://github.com/bitwarden/server/releases/download/v{{ bitwarden_version }}/docker-stub.zip'
bitwarden_stub_path: '/opt/bitwarden'
# Folder permissions
bitwarden_owner: '{{ bitwarden_container_uid }}'
bitwarden_group: '{{ bitwarden_container_gid }}'

# for env/global.override.env
bitwarden_global_settings:
  adminSettings__admins: '{{ bitwarden_admin_emails | join(",") }}'
  globalSettings__attachment__baseDirectory: '/etc/bitwarden/core/attachments'
  globalSettings__attachment__baseUrl: 'https://{{ bitwarden_domain | mandatory }}/attachments'
  globalSettings__baseServiceUri__admin: 'https://{{ bitwarden_domain | mandatory }}/admin'
  globalSettings__baseServiceUri__api: 'https://{{ bitwarden_domain | mandatory }}/api'
  globalSettings__baseServiceUri__identity: 'https://{{ bitwarden_domain | mandatory }}/identity'
  globalSettings__baseServiceUri__notifications: 'https://{{ bitwarden_domain | mandatory }}/notifications'
  globalSettings__baseServiceUri__vault: 'https://{{ bitwarden_domain | mandatory }}'
  globalSettings__dataProtection__directory: '/etc/bitwarden/core/aspnet-dataprotection'
  globalSettings__disableUserRegistration: '{{ bitwarden_disable_registration | string | lower }}'
  globalSettings__duo__aKey: '{{ bitwarden_duo_akey }}'
  globalSettings__hibpApiKey: '{{ bitwarden_duo_hibp_api_key }}'
  globalSettings__identityServer__certificatePassword: '{{ bitwarden_id_cert_pass | mandatory }}'
  globalSettings__installation__id: '{{ bitwarden_inst_id | mandatory }}'
  globalSettings__installation__key: '{{ bitwarden_inst_key | mandatory }}'
  globalSettings__internalIdentityKey: '{{ bitwarden_id_key | mandatory }}'
  globalSettings__licenseDirectory: '/etc/bitwarden/core/licenses'
  globalSettings__logDirectory: '/etc/bitwarden/logs'
  globalSettings__mail__replyToEmail: '{{ bitwarden_reply_email | mandatory }}'
  globalSettings__mail__smtp__host: '{{ bitwarden_smtp_host | mandatory }}'
  globalSettings__mail__smtp__password: '{{ bitwarden_smtp_pass | mandatory }}'
  globalSettings__mail__smtp__port: '{{ bitwarden_smtp_port | mandatory }}'
  globalSettings__mail__smtp__ssl: '{{ bitwarden_smtp_ssl | mandatory }}'
  globalSettings__mail__smtp__username: '{{ bitwarden_smtp_user | mandatory }}'
  globalSettings__sqlServer__connectionString: '"Data Source=tcp:mssql,1433;Initial Catalog=vault;Persist Security Info=False;User ID=sa;Password={{ bitwarden_db_pass | mandatory }};MultipleActiveResultSets=False;Connect Timeout=30;Encrypt=True;TrustServerCertificate=True"'
  globalSettings__yubico__clientId: '{{ bitwarden_yubico_client_id }}'
  globalSettings__yubico__key: '{{ bitwarden_yubico_secret_key }}'

# for env/mssql.override.env
bitwarden_mssql_settings:
  ACCEPT_EULA: Y
  MSSQL_PID: Express
  SA_PASSWORD: '{{ bitwarden_db_pass | mandatory }}'

bitwarden_docker_settings:
  ASPNETCORE_ENVIRONMENT: 'Production'
  globalSettings__selfHosted: 'true'
  globalSettings__baseServiceUri__vault: 'https://{{ bitwarden_domain }}'
  globalSettings__baseServiceUri__api: 'https://{{ bitwarden_domain }}/api'
  globalSettings__baseServiceUri__identity: 'https://{{ bitwarden_domain }}/identity'
  globalSettings__baseServiceUri__admin: 'https://{{ bitwarden_domain }}/admin'
  globalSettings__baseServiceUri__notifications: 'https://{{ bitwarden_domain }}/notifications'
  globalSettings__baseServiceUri__internalNotifications: 'http://notifications:{{ bitwarden_listen_port }}'
  globalSettings__baseServiceUri__internalAdmin: 'http://admin:{{ bitwarden_listen_port }}'
  globalSettings__baseServiceUri__internalIdentity: 'http://identity:{{ bitwarden_listen_port }}'
  globalSettings__baseServiceUri__internalApi: 'http://api:{{ bitwarden_listen_port }}'
  globalSettings__baseServiceUri__internalVault: 'http://web:{{ bitwarden_listen_port }}'
  globalSettings__pushRelayBaseUri: 'https://push.bitwarden.com'
  globalSettings__installation__identityUri: 'https://identity.bitwarden.com'
